ä¸€ã€ åˆ é™¤â€œé¦–é¡µâ€èœå• (ä¿®æ”¹ MainFrame.java)
æˆ‘ä»¬éœ€è¦æŠŠå·¦ä¾§çš„â€œé¦–é¡µâ€æŒ‰é’®å‰¥ç¦»ï¼Œå¹¶è®©ç³»ç»Ÿç™»å½•åç›´æ¥è¿›å…¥â€œç»è¥æ€»è§ˆâ€æˆ–â€œå‘˜å·¥è€ƒå‹¤â€ã€‚

æ‰“å¼€ MainFrame.javaï¼Œè¿›è¡Œä»¥ä¸‹åˆ é™¤å’Œä¿®æ”¹ï¼š

åˆ é™¤æŒ‰é’®å£°æ˜ï¼šæ‰¾åˆ° private JButton homeBtn; å¹¶åˆ é™¤å®ƒã€‚

åˆ é™¤é¢æ¿æ·»åŠ ï¼šæ‰¾åˆ° contentPanel.add(createHomePanel(), "HOME"); å¹¶åˆ é™¤ã€‚

æ›´æ”¹é»˜è®¤é¡µï¼šæ‰¾åˆ° private String currentPage = "HOME"; æ”¹ä¸º private String currentPage = "SUMMARY";ã€‚

åˆ é™¤èœå•é¡¹ï¼šåœ¨ createNavPanel() æ–¹æ³•ä¸­ï¼Œåˆ é™¤ homeBtn = createNavButton("H", "é¦–é¡µ", "HOME"), è¿™ä¸€è¡Œã€‚

åˆ é™¤æ— ç”¨æ–¹æ³•ï¼šæŠŠæ•´ä¸ª createHomePanel() æ–¹æ³•å…¨éƒ¨åˆ æ‰ã€‚

äºŒã€ ä¼˜åŒ–è€ƒå‹¤è¡¨ï¼šä¸€é¡µçœ‹å…¨ + å¢åŠ å‡ºå‹¤æ€»æ—¶é•¿ç»Ÿè®¡ (ä¿®æ”¹ AttendancePanel.java)
ç”±äºä½ ä¸å†éœ€è¦â€œè¿Ÿåˆ°/æ—©é€€â€ç­‰çŠ¶æ€ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ ¼å­é‡Œå¡«å…¥æ—¶é•¿æ•°å­—ã€‚åŒæ—¶å–æ¶ˆè¡¨æ ¼çš„æ¨ªå‘æ»šåŠ¨ï¼Œå¢åŠ â€œä¸ªäººæ€»æ—¶é•¿â€åˆ—å’Œåº•éƒ¨çš„â€œæ‰€æœ‰å‘˜å·¥æ€»æ—¶é•¿â€æ±‡æ€»ã€‚

è¯·æ‰¾åˆ° AttendancePanel.java ä¸­çš„ createMonthlyView() å’Œ refreshMonthlyTable() æ–¹æ³•ï¼Œå¹¶å°†å…¶å…¨éƒ¨æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç ï¼š

Java
    // æ–°å¢ä¸€ä¸ªå…¨å±€å˜é‡ç”¨äºæ˜¾ç¤ºæ€»æ±‡æ€»
    private JLabel grandTotalLabel;

    private JPanel createMonthlyView() {
        JPanel panel = new JPanel(new BorderLayout());
        panel.setBackground(UIUtils.COLOR_BG_MAIN);
        
        // ... (æŸ¥è¯¢å·¥å…·æ  queryPanel çš„ä»£ç ä¿æŒä¸å˜ï¼Œä¿ç•™å¹´ä»½ã€æœˆä»½ã€åˆ·æ–°ã€å½•å…¥æŒ‰é’®) ...
        // æ³¨æ„ï¼šæŠŠ queryPanel æ·»åŠ åˆ° NORTH çš„é€»è¾‘ä¿ç•™
        panel.add(queryPanel, BorderLayout.NORTH);
        
        // è€ƒå‹¤è¡¨æ ¼ - å…± 33 åˆ— (å§“å + 31å¤© + æ€»æ—¶é•¿)
        String[] columnNames = new String[33];
        columnNames[0] = "å§“å";
        for (int i = 1; i <= 31; i++) {
            columnNames[i] = i + "æ—¥";
        }
        columnNames[32] = "æ€»æ—¶é•¿(h)"; // æ–°å¢åˆ—

        monthlyModel = new DefaultTableModel(columnNames, 0) {
            @Override
            public boolean isCellEditable(int row, int column) { return false; }
        };
        
        monthlyTable = new JTable(monthlyModel);
        monthlyTable.setRowHeight(30);
        monthlyTable.setFont(UIUtils.FONT_NORMAL);
        
        // ã€å…³é”®ä¿®å¤ã€‘ï¼šè®©è¡¨æ ¼è‡ªåŠ¨ç¼©æ”¾é€‚åº”å±å¹•ï¼Œä¸å†å‡ºç°æ¨ªå‘æ»šåŠ¨æ¡
        monthlyTable.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);
        
        // è°ƒæ•´åˆ—å®½æƒé‡
        monthlyTable.getColumnModel().getColumn(0).setPreferredWidth(60); // å§“åç¨å¾®å®½ç‚¹
        for (int i = 1; i <= 31; i++) {
            monthlyTable.getColumnModel().getColumn(i).setPreferredWidth(25); // æ¯å¤©çš„æ ¼å­å˜çª„
        }
        monthlyTable.getColumnModel().getColumn(32).setPreferredWidth(60); // æ€»æ—¶é•¿ç¨å¾®å®½ç‚¹
        
        JScrollPane scrollPane = new JScrollPane(monthlyTable);
        panel.add(scrollPane, BorderLayout.CENTER);
        
        // ã€æ–°å¢ã€‘ï¼šåº•éƒ¨æ‰€æœ‰å‘˜å·¥å‡ºå‹¤æ—¶é•¿æ±‡æ€»é¢æ¿
        JPanel bottomPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 20, 10));
        bottomPanel.setBackground(UIUtils.COLOR_BG_CARD);
        grandTotalLabel = new JLabel("å½“æœˆæ‰€æœ‰å‘˜å·¥å‡ºå‹¤æ€»æ—¶é•¿: 0.0 h");
        grandTotalLabel.setFont(new Font("Microsoft YaHei", Font.BOLD, 16));
        grandTotalLabel.setForeground(UIUtils.COLOR_PRIMARY);
        bottomPanel.add(grandTotalLabel);
        
        panel.add(bottomPanel, BorderLayout.SOUTH);
        
        refreshMonthlyTable();
        return panel;
    }

    private void refreshMonthlyTable() {
        monthlyModel.setRowCount(0);
        
        String year = (String) yearBox.getSelectedItem();
        String month = (String) monthBox.getSelectedItem();
        
        List<Employee> employees = DataManager.getInstance().getEmployees();
        List<AttendanceRecord> monthRecords = DataManager.getInstance().getAttendanceByMonth(year, month);
        
        double grandTotalHours = 0.0; // æ‰€æœ‰äººæ€»æ—¶é•¿
        
        for (Employee emp : employees) {
            Object[] rowData = new Object[33];
            rowData[0] = emp.getName();
            
            double empTotalHours = 0.0; // å•ä¸ªå‘˜å·¥æ€»æ—¶é•¿
            
            // è·å–è¯¥å‘˜å·¥å½“æœˆçš„æ‰€æœ‰è®°å½•
            List<AttendanceRecord> myRecords = monthRecords.stream()
                    .filter(r -> r.getEmployeeId().equals(emp.getId()))
                    .collect(Collectors.toList());
            
            for (AttendanceRecord r : myRecords) {
                int day = r.getDayOfMonth();
                if (day >= 1 && day <= 31) {
                    // ç›´æ¥å¡«å…¥å·¥ä½œæ—¶é•¿ï¼ˆä¹‹å‰å« overtimeHoursï¼Œç°åœ¨ä»£è¡¨å®é™…å½•å…¥çš„æ•°å­—æ—¶é•¿ï¼‰
                    double hours = r.getOvertimeHours(); 
                    rowData[day] = hours > 0 ? String.valueOf(hours) : "";
                    empTotalHours += hours;
                }
            }
            
            rowData[32] = String.format("%.1f", empTotalHours); // å¡«å…¥è¯¥å‘˜å·¥ä¸ªäººæ€»æ—¶é•¿
            grandTotalHours += empTotalHours; // ç´¯åŠ åˆ°å…¨å±€æ€»è®¡
            
            monthlyModel.addRow(rowData);
        }
        
        // æ›´æ–°åº•éƒ¨å…¨å±€æ±‡æ€»æ ‡ç­¾
        if (grandTotalLabel != null) {
            grandTotalLabel.setText(String.format("å½“æœˆæ‰€æœ‰å‘˜å·¥å‡ºå‹¤æ€»æ—¶é•¿: %.1f h", grandTotalHours));
        }
    }
ä¸‰ã€ å½»åº•é‡å†™ Excel æ•°æ®å¯¼å…¥åŠŸèƒ½ (ä¿®æ”¹ AttendanceImporter.java)
æ ¹æ®ä½ ä¸Šä¼ çš„ CSV/Excel ç»“æ„ï¼ˆæ ‡å‡†é’‰é’‰æ‰“å¡å¯¼å‡ºæ ¼å¼ï¼šåˆ—0æ˜¯å§“åï¼Œåˆ—6æ˜¯å®é™…å‡ºå‹¤å°æ—¶ï¼Œåˆ—7æ˜¯è®¡è–ªæ—¶é•¿ï¼‰ï¼Œä¸€ä¸ªäººä¼šå æ®å¤šè¡Œï¼ˆæ’ç­è¡Œã€æ‰“å¡æ—¶é—´è¡Œç­‰ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦æŠ“å–å¸¦æœ‰å§“åçš„é‚£ä¸€è¡Œï¼ˆé€šå¸¸æ˜¯æ¯ä¸ªäººçš„ç¬¬ä¸€è¡Œï¼‰çš„æ ¸å¿ƒæ•°æ®ã€‚

å°† AttendanceImporter.java ä¸­çš„ importFromExcel æ–¹æ³•å½»åº•æ›¿æ¢ä¸ºä»¥ä¸‹è§£æé€»è¾‘ï¼š

Java
    public static List<MonthlyAttendance> importFromExcel(String filePath) throws IOException {
        List<MonthlyAttendance> records = new ArrayList<>();
        
        try (FileInputStream fis = new FileInputStream(filePath);
             Workbook workbook = new XSSFWorkbook(fis)) {
            
            Sheet sheet = workbook.getSheetAt(0);
            String month = extractMonthFromFileName(filePath);
            
            // éå†æ‰€æœ‰è¡Œï¼Œå¯»æ‰¾å‘˜å·¥æ•°æ®èµ·å§‹è¡Œ
            for (int rowNum = 0; rowNum <= sheet.getLastRowNum(); rowNum++) {
                Row row = sheet.getRow(rowNum);
                if (row == null) continue;
                
                Cell nameCell = row.getCell(0); // ä½ çš„è¡¨æ ¼ä¸­ï¼Œå§“ååœ¨ç¬¬ 0 åˆ— (Aåˆ—)
                if (nameCell == null) continue;
                
                String name = getCellValue(nameCell).trim();
                // æ’é™¤è¡¨å¤´å’Œç©ºè¡Œ
                if (name.isEmpty() || name.equals("å§“å") || name.equals("åŸºæœ¬ä¿¡æ¯")) {
                    continue;
                }
                
                // èµ°åˆ°è¿™é‡Œè¯´æ˜è¯»åˆ°äº†å…·ä½“çš„å‘˜å·¥è¡Œ
                String empId = getCellValue(row.getCell(1)); // å·¥å·åœ¨ Båˆ—
                
                // æ ¹æ®ä½ çš„è¡¨å¤´ï¼š6æ˜¯"å®é™…å‡ºå‹¤(å°æ—¶)", 7æ˜¯"è®¡è–ªæ—¶é•¿(å°æ—¶)"
                double actualHours = getCellDoubleValue(row, 6);
                double paidHours = getCellDoubleValue(row, 7); 
                
                MonthlyAttendance record = new MonthlyAttendance(
                    empId.isEmpty() || empId.equals("-") ? null : empId,
                    name, 
                    month, 
                    0, 0, 0, // ç•¥è¿‡ä¸å…³å¿ƒçš„å¤©æ•°
                    actualHours, 
                    paidHours, 
                    0, 0
                );
                
                // é’‰é’‰å¯¼å‡ºçš„è¡¨ä¸€ä¸ªäººä¼šæœ‰å¥½å‡ è¡Œï¼ˆæ¯”å¦‚æ‰“å¡æ—¶é—´ï¼‰ï¼Œä½†åªæœ‰ç¬¬ä¸€è¡Œæœ‰å®Œæ•´æ±‡æ€»æ•°æ®ã€‚
                // å¦‚æœ List ä¸­è¿˜æ²¡åŠ è¿‡è¿™ä¸ªäººï¼Œå°±åŠ è¿›å»ï¼Œé¿å…é‡å¤è¯»å–ä¸‹é¢çš„ç©ºè¡Œæ•°æ®
                boolean exists = records.stream().anyMatch(r -> r.getEmployeeName().equals(name));
                if (!exists) {
                    records.add(record);
                }
            }
        } catch (Exception e) {
            // å¦‚æœé‡åˆ° CSV æ–‡ä»¶ï¼ŒPOI æ— æ³•è¯»å–ï¼Œå»ºè®®ä½ åœ¨å¯¼å…¥å‰ç”¨ Excel å°†å…¶å¦å­˜ä¸º .xlsx æ ¼å¼å†å¯¼å…¥
            throw new IOException("è¯»å–æ–‡ä»¶å¤±è´¥ï¼Œè¯·ç¡®ä¿å¯¼å…¥çš„æ˜¯ .xlsx æ ¼å¼çš„ Excel æ–‡ä»¶ï¼", e);
        }
        
        return records;
    }
å››ã€ åˆ é™¤èŠ±é‡Œèƒ¡å“¨çš„å›¾æ ‡ï¼Œä¿®å¤æ–¹æ¡†å’Œæ’ç‰ˆé”™ä¹±
å›¾æ ‡å˜æˆâ€œæ–¹æ¡†â€ï¼Œæ˜¯å› ä¸ºä½ ç”µè„‘æ“ä½œç³»ç»Ÿçš„é»˜è®¤å­—ä½“åº“ä¸æ”¯æŒé‚£äº›ç‰¹å®šçš„ Emoji ç¬¦å·ï¼ˆæ¯”å¦‚ ğŸ‘¤, ğŸ”’, ğŸ“, ğŸ”„ï¼‰ã€‚

å…¨å±€æœç´¢æ¸…ç† Emojiï¼š
åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼ˆç‰¹åˆ«æ˜¯ LoginFrame.javaã€MainFrame.javaã€SummaryPanel.javaã€AttendancePanel.java ä¸­ï¼‰ï¼Œç”¨ IDE çš„å…¨å±€æœç´¢åŠŸèƒ½ï¼ˆCtrl+Shift+Fï¼‰ï¼Œæœç´¢è¯¸å¦‚ ğŸ‘¤, ğŸ”’, ğŸ“, ğŸ”„, âš ï¸, ğŸ‘¥, ğŸ“¦ ç­‰å­—ç¬¦ï¼Œç›´æ¥åˆ æ‰æˆ–è€…æ›¿æ¢æˆä¸­æ–‡ï¼ˆå¦‚æŠŠ "ğŸ”„ åˆ·æ–°æ•°æ®" æ”¹ä¸º "åˆ·æ–°æ•°æ®"ï¼‰ã€‚

ä¿®å¤ç™»å½•ç•Œé¢æ’ç‰ˆ (LoginFrame.java)ï¼š
ä¸è¦ç”¨å¤æ‚çš„åµŒå¥— Panelã€‚æ‰“å¼€ LoginFrame.java çš„ createLoginPanel()ï¼ŒæŠŠè¾“å…¥æ¡†éƒ¨åˆ†æ”¹æˆæœ€æœ´ç´ çš„å½¢å¼ï¼š

Java
// å»æ‰ userIcon é‚£äº›èŠ±å“¨è®¾ç½®
JLabel userLabel = new JLabel("è´¦ å·:");
usernameField = new JTextField(15);

JLabel pwdLabel = new JLabel("å¯† ç :");
passwordField = new JPasswordField(15);

// æŠŠå®ƒä»¬ç›´æ¥ add åˆ°ä½ çš„ panel é‡Œå³å¯ï¼Œè¶Šç®€å•è¶Šä¸ä¼šé”™ä½