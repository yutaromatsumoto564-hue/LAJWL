ä¸€ã€ è§£å†³å›¾æ ‡æ–¹æ¡†ã€æ’ç‰ˆé”™ä¹±ä¸ç™»å½•ç•Œé¢é—®é¢˜ï¼ˆåˆ é™¤å†—ä½™ UIï¼‰
1. å‰¥ç¦» LoginFrame.java çš„èŠ±å“¨ä»£ç 

åˆ é™¤ createSplashPanel() åŠå…¶ç›¸å…³çš„å¼€åœºåŠ¨ç”»é€»è¾‘ã€Timer å»¶è¿Ÿåˆ‡æ¢ä»£ç ã€‚

åˆ é™¤ createLoginPanel() ä¸­çš„ paintComponent é‡å†™ï¼ˆå»æ‰æ¸å˜èƒŒæ™¯ï¼‰ã€‚

æ›¿æ¢å›¾æ ‡ä¸ºæ–‡å­—ï¼š
æ‰¾åˆ° JLabel userIcon = new JLabel("ğŸ‘¤"); å’Œ JLabel pwdIcon = new JLabel("ğŸ”’");ï¼Œå°†å…¶ç›´æ¥æ”¹ä¸ºï¼š

Java
JLabel userIcon = new JLabel("è´¦å·:");
JLabel pwdIcon = new JLabel("å¯†ç :");
å»ºè®®ï¼šæŠŠå¤æ‚çš„ BoxLayout å’Œ BorderLayout åµŒå¥—å…¨åˆ æ‰ï¼Œç›´æ¥ç”¨æœ€ç®€å•çš„ç»å¯¹å¸ƒå±€ï¼ˆsetLayout(null)ï¼‰æˆ–æ ‡å‡†çš„ GridLayout(2, 2) æ¥æ”¾è´¦å·ã€å¯†ç çš„ Label å’Œè¾“å…¥æ¡†ã€‚

2. å‰¥ç¦» UIUtils.java ä¸­çš„é‡ç»˜ä»£ç 

åˆ é™¤æˆ–ç®€åŒ– createButton()ã€createDangerButton() ç­‰æ–¹æ³•ä¸­æ‰€æœ‰é‡å†™ paintComponent çš„ä»£ç ã€‚åŸç”Ÿçš„ new JButton("æ–‡æœ¬") æœ€ç¨³å®šï¼Œä¸ä¼šå› ä¸ºåœ†è§’ç»˜åˆ¶å¯¼è‡´ç‚¹å‡»äº‹ä»¶æ¼‚ç§»æˆ–æ’ç‰ˆé”™ä¹±ï¼ˆè¿™å¯èƒ½ä¹Ÿæ˜¯ä½ â€œç¼–è¾‘åŠŸèƒ½æ²¡ç”Ÿæ•ˆâ€çš„åŸå› ä¹‹ä¸€ï¼Œå› ä¸ºè‡ªå®šä¹‰æŒ‰é’®çš„ç‚¹å‡»ç©¿é€æˆ–ç„¦ç‚¹ä¸¢å¤±ï¼‰ã€‚

å…¨å±€æœç´¢ "ğŸ“"ã€"ğŸ’¼"ã€"ğŸ”"ã€"ğŸ”„"ã€"âš ï¸" ç­‰ Emoji ç¬¦å·ï¼Œå…¨éƒ¨åˆ é™¤æˆ–æ›¿æ¢ä¸ºæ™®é€šæ±‰å­—ï¼ˆå¦‚â€œæœç´¢â€ã€â€œåˆ·æ–°â€ï¼‰ã€‚

äºŒã€ ç¡®ä¿â€œç¼–è¾‘åŠŸèƒ½â€ç”Ÿæ•ˆçš„æ ¸å¿ƒæ’æŸ¥
ç¼–è¾‘åŠŸèƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼Œé€šå¸¸æ˜¯å› ä¸ºè¡¨æ ¼è§†å›¾ï¼ˆViewï¼‰å’Œåº•å±‚æ•°æ®ï¼ˆModelï¼‰è„±èŠ‚ã€‚
åœ¨ ExpensePanel.javaï¼ˆæˆ–å…¶ä»– Panelï¼‰çš„ç¼–è¾‘æŒ‰é’®äº‹ä»¶ä¸­ï¼Œè¯·åŠ¡å¿…ç¡®ä¿æŒ‰ä»¥ä¸‹ä¸‰æ­¥èµ°ï¼š

å–æ­£ç¡®çš„æ•°æ®ç´¢å¼•ï¼šint row = table.getSelectedRow();

æ›´æ–° DataManagerï¼šæŠŠå¼¹çª—è¿”å›çš„ä¿®æ”¹åçš„å¯¹è±¡ï¼Œæ›¿æ¢æ‰ List é‡Œå¯¹åº”çš„å¯¹è±¡ã€‚

Java
// å¿…é¡»æœ‰è¿™ä¸€æ­¥å°†ä¿®æ”¹åŒæ­¥åˆ°å†…å­˜
DataManager.getInstance().getExpenseRecords().set(row, updatedRecord); 
// DataManager ä¸­å¿…é¡»è°ƒç”¨å¯¹åº”çš„ save æ–¹æ³•å†™å…¥ .dat æ–‡ä»¶
DataManager.getInstance().saveExpenses(); 
åˆ·æ–°è¡¨æ ¼è§†å›¾ï¼šå¿…é¡»è°ƒç”¨ model.setRowCount(0); ç„¶åé‡æ–° for å¾ªç¯æ·»åŠ è¡Œï¼Œæˆ–è€…ç›´æ¥è°ƒç”¨ä½ å†™çš„ refreshData(); æ–¹æ³•ï¼Œå¦åˆ™ç•Œé¢è¿˜æ˜¯è€æ•°æ®ã€‚

ä¸‰ã€ è€ƒå‹¤è¡¨ä¸€é¡µå±•ç¤ºï¼ˆæ¶ˆé™¤æ¨ªå‘æ»šåŠ¨æ¡ï¼‰
å½“å‰ 1~31 å·éœ€è¦æ»šåŠ¨æ˜¯å› ä¸ºåˆ—å¤ªå®½ï¼Œä¸”è¡¨æ ¼ä¸å…è®¸è‡ªåŠ¨æŒ¤å‹ã€‚

ä¿®æ”¹ AttendancePanel.java çš„ createMonthlyView() æ–¹æ³•ï¼š

åˆ é™¤ï¼šmonthlyTable.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

ä¿®æ”¹ä¸ºï¼šmonthlyTable.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS); ï¼ˆè®©è¡¨æ ¼è‡ªåŠ¨æ‹‰ä¼¸å¡«æ»¡å¯è§†åŒºåŸŸï¼‰

ç¼©å‡åˆ—å®½ï¼šæŠŠå¾ªç¯é‡Œçš„ setPreferredWidth(40) æ”¹å¾—æå°ï¼ˆæ¯”å¦‚ 20 æˆ– 25ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬é©¬ä¸Šè¦æŠŠå®ƒæ”¹æˆåªæ˜¾ç¤ºä¸€ä¸ªæ•°å­—ã€‚

å››ã€ è€ƒå‹¤æ•°æ®å¯¼å…¥ä¸å½•å…¥é‡å†™ï¼ˆå–æ¶ˆè¿Ÿåˆ°æ—©é€€ï¼Œç›´æ¥è¾“æ—¶é•¿ï¼‰
æ—¢ç„¶åªå…³å¿ƒå·¥ä½œäº†å¤šå°‘å°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç æ‰å¤šä½™çš„åˆ†ç±»ã€‚

1. ä¿®æ”¹ AttendanceRecord.java

åˆ é™¤ private String status; å­—æ®µã€‚

å°† overtimeHours å­—æ®µæ”¹åä¸ºæ›´ç›´æ¥çš„ workHoursï¼ˆå‡ºå‹¤æ—¶é•¿ï¼‰ã€‚

2. ä¿®æ”¹ AttendanceDialog.javaï¼ˆæ‰‹åŠ¨å½•å…¥ç•Œé¢ï¼‰

åˆ é™¤ å…³äº statusBoxï¼ˆæ­£å¸¸ã€è¿Ÿåˆ°ã€æ—©é€€ä¸‹æ‹‰æ¡†ï¼‰çš„æ‰€æœ‰ä»£ç ã€‚

å°† overtimeField çš„æ ‡ç­¾æ”¹ä¸º "å‡ºå‹¤æ—¶é•¿(h):"ã€‚

getData() æ–¹æ³•ç›´æ¥è¿”å›è¾“å…¥çš„æ•°å€¼ï¼ˆå°æ—¶ï¼‰ã€‚

3. ä¿®æ”¹ AttendancePanel.java æ˜¾ç¤ºé€»è¾‘

åœ¨ refreshMonthlyTable() å¾ªç¯ä¸­ï¼Œåˆ é™¤åˆ¤æ–­é€»è¾‘ï¼š

Java
// åˆ æ‰è¿™å †åˆ¤æ–­
// if ("è¿Ÿåˆ°".equals(r.getStatus())) symbol = "L"; ...
æ”¹ä¸ºç›´æ¥æ˜¾ç¤ºæ—¶é•¿ï¼š

Java
rowData[day] = String.valueOf(r.getWorkHours()); // ç›´æ¥å¡«å…¥ 8.0, 9.5 ç­‰æ•°å­—
äº”ã€ æ•°æ®å¤‡ä»½é‡å†™ï¼ˆç”Ÿæˆ Excel æœˆåº¦è¡¨æ ¼ï¼‰
ä½ ä¹‹å‰åœ¨ pom.xml ä¸­å·²ç»å¼•å…¥äº† org.apache.poi:poi-ooxml:5.2.3ã€‚ç°åœ¨çš„ .dat å’Œ .zip å¤‡ä»½å¯¹æ™®é€šäººä¸å¯è¯»ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹ BackupManager.javaï¼Œè®©å…¶ç”ŸæˆçœŸå®çš„ .xlsxã€‚

é‡å†™ BackupManager.java å»ºè®®æ–¹æ¡ˆï¼š
æŠ›å¼ƒå‹ç¼© .dat æ–‡ä»¶çš„åšæ³•ï¼Œç›´æ¥æŸ¥å‡ºæ•°æ®å†™å…¥ Excelï¼š

Java
package com.jinwanli;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.io.FileOutputStream;
import java.io.File;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import com.jinwanli.model.*;

public class BackupManager {
    public static void performBackup() {
        try {
            File backupDir = new File("backup");
            if (!backupDir.exists()) backupDir.mkdirs();

            String timestamp = new SimpleDateFormat("yyyy-MM").format(new Date());
            String fileName = "backup/é‡‘ä¸‡é‡Œæœˆåº¦æ•°æ®å¤‡ä»½_" + timestamp + ".xlsx";
            
            Workbook workbook = new XSSFWorkbook();
            
            // 1. ç”Ÿæˆé”€å”®è®°å½• Sheet
            Sheet salesSheet = workbook.createSheet("é”€å”®è®°å½•");
            Row salesHeader = salesSheet.createRow(0);
            salesHeader.createCell(0).setCellValue("æ—¥æœŸ");
            salesHeader.createCell(1).setCellValue("å®¢æˆ·");
            salesHeader.createCell(2).setCellValue("æ€»é‡‘é¢");
            List<SalesRecord> sales = DataManager.getInstance().getSalesRecords();
            int r = 1;
            for (SalesRecord record : sales) {
                Row row = salesSheet.createRow(r++);
                row.createCell(0).setCellValue(record.getDate());
                row.createCell(1).setCellValue(record.getShipperName());
                row.createCell(2).setCellValue(record.getTotalAmount());
            }

            // 2. ç”Ÿæˆå¼€æ”¯è®°å½• Sheet (åŒç†)
            Sheet expenseSheet = workbook.createSheet("å¼€æ”¯ä¸æŠ•èµ„è®°å½•");
            // ... å†™å…¥è¡¨å¤´å’Œ ExpenseRecords æ•°æ® ...

            // 3. ç”Ÿæˆè€ƒå‹¤è®°å½• Sheet (åŒç†)
            Sheet attendanceSheet = workbook.createSheet("è€ƒå‹¤æ•°æ®(å°æ—¶)");
            // ... å†™å…¥è¡¨å¤´å’Œ AttendanceRecords æ•°æ® ...

            // è¾“å‡ºåˆ°æ–‡ä»¶
            try (FileOutputStream out = new FileOutputStream(fileName)) {
                workbook.write(out);
            }
            workbook.close();
            
            javax.swing.JOptionPane.showMessageDialog(null, "æˆåŠŸç”ŸæˆæŠ¥è¡¨ï¼š" + fileName);

        } catch (Exception e) {
            e.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(null, "å¤‡ä»½å¯¼å‡ºå¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
æ‰§è¡Œå»ºè®®ï¼š
æŠŠä½ é¡¹ç›®é‡Œè·Ÿ paintComponent å’Œ Graphics2D æ²¾è¾¹çš„ä¸ºäº†â€œå¥½çœ‹â€å†™çš„ä»£ç å…ˆå¤§åˆ€é˜”æ–§åœ°ç æ‰ã€‚ç•Œé¢æ¢å›é»˜è®¤çš„ç°è‰²é£æ ¼ï¼ŒæŠŠå„ä¸ª Dialog é‡Œçš„è¾“å…¥æ¡†å¯¹é½ï¼Œå…ˆè·‘é€šâ€œç¼–è¾‘â€å’Œâ€œçº¯æ•°å­—è€ƒå‹¤å½•å…¥â€è¿™ä¸¤æ¡çº¿ï¼æœ‰é—®é¢˜å¯ä»¥è´´å…·ä½“æŠ¥é”™æˆ–ç°è±¡ã€‚